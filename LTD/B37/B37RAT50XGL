.pm 20mm
.BR
.NV PAGE BANKSTED '%&EKSPBNKST.'
.BR
.NV PAGE BANK-EKSPEDIENT '%&BRUGERNR.'
.BR
.NV PAGE PRINTER '%&PRINTER.'
.BR
.NV PAGE TØMPOSTKASSE '%&U'&TØMPOST.'
.BR
.NV PAGE FORCERTØM '%&U'&FORCER.'
.BR
.NV PAGE PDFFORMAT '%&U'&PDFFORMAT.'
.*
.* DATO på parameterlisten vist og kan frigives
.*Ændring hvor linien starter med * MB ********
.da KUNDEOPL       25mm  48mm   width  84mm
.da CPRSENR       120mm  68.6mm width  84mm
.da PIOPL          25mm  76.6mm width  84mm
.da KTOOPL        118mm  78mm   width  76mm
.da DATO          133mm  93.5mm width  20mm
.da INDBPRIFAST    25mm 110.4mm width 160mm
.da INDBPRIENG     25mm 110.4mm width 160mm
.da INDBPRIOPF     25mm 132mm   width 160mm
.da INDBPRI15A    25mm 110.4mm width 160mm
.*******************************************
.**** test ratepensionstype *************
.if &L'&GENPRIFAST > 0
.th .go TEST2
.if &L'&GENPRIENGA > 0
.th .go TEST3
.if &L'&GENPRIOPFY > 0
.th .go TEST4
.if &L'&GENPRI15A > 0
.th .go OKTEST
.el .mg /T/Ratepensionstype skal vælges/
...TEST2
.if &L'&GENPRIENGA > 0
.or &L'&GENPRIOPFY > 0
.or &L'&GENPRI15A > 0
.th .go FEJL
.el .go OKTEST
...TEST3
.if &L'&GENPRIOPFY > 0
.or &L'&GENPRI15A > 0
.th .go FEJL
.el .go OKTEST
...TEST4
.if &L'&GENPRI15A > 0
.th .go FEJL
.el .go OKTEST
.******************
...FEJL
.th .mg /T/Højst een ratepensionstype må vælges/
...OKTEST
.*** test beløb ***************************
.if &L'&GENPRIFAST > 0
.th .go PRIGIVSL
.if &L'&GENPRIOPFY > 0
.th .go TESTBEL
.**** beløbstest for engangsindskud ********
.if &L'&GENPRIENGA = 0
.th .go BEL15A
.if &L'&RESULTA gt 4
.th .go PRIGIVSL
.if &L'&RESULTA eq 4
.an X&RESULTA gt X0,00
.th .go PRIGIVSL
.* MB el .mg /T/Indbetalingsbeløb skal indtastes på engangsindskud/
...BEL15A
.**** beløbstest for § 15 A ****************
.if &L'&GENPRI15A = 0
.th .go PRIGIVSL
.if &L'&RESULTA gt 4
.th .go BEL15A1
.if &L'&RESULTA eq 4
.an X&RESULTA gt 0,00
.th .go PRIGIVSL
.el .mg /T/Indbetalingsbeløb skal indtastes på § 15A ordning/
.********
...BEL15A1
.if &L'&RESULTA gt 12
.th .mg /T/Der kan max. indbetales 2 mio. på § 15A ordning/
.if &L'&RESULTA lt 12
.th .go PRIGIVSL
.if X&RESULTA le X2.000.000,00
.th .go PRIGIVSL
.el .mg /T/Der kan max. indbetales 2 mio. på § 15A ordning/
.**** beløbstest for op til opfyldningsfradrag ****************************
...TESTBEL
.if &L'&RESULTA gt 9
.th .mg /T/Indbetalingsbeløb > 36.500 /
.if &L'&RESULTA lt 9
.th .go PRIGIVSL
.if X&RESULTA gt X36.500,00
.th .mg /T/Indbetalingsbeløb > 36.500/
...PRIGIVSL
.**** test frekvens **************
.if &L'&GENPRIENGA > 0
.or &L'&GENPRIOPFY > 0
.or &L'&GENPRI15A > 0
.th .go EJFREKV
.**** kun for genprifast *****
.if &L'&GENLØNINDB = 0
.th .mg /T/Frekvens skal vælges/
.if x&GENLØNINDB < x1
.or x&GENLØNINDB > x6
.th .mg /T/Frekvens skal have værdien 1-6/
...EJFREKV
.*******************
.if &L'&GENPRISTAL eq 0
.th .go PRISTAL
.if x&GENPRISTAL < x1
.or x&GENPRISTAL > x4
.th .mg /T/Ved pristalsregulering skal indeks være 1-4/
...PRISTAL
.*****************
.ar KUNDEOPL on
&NAVN
.br
&COADR
.br
&GADE
.br
&BY
.ar off
.*****************
.ar PIOPL on
&BANKNAVN
.br
&AFDNAVN
.br
&AFDGADE
.br
&AFDBY
.ar off
.*******************
.ar KTOOPL on
.***** HER DELES REGISTRERINGSNUMMER OG KTONUMMER OP I TO PARAMETRE ****
.se regnr = substr &IREGKTO 1 4
.se ktonr = substr &IREGKTO 5 7
.tp 43mm
&KTOKNDNR1
.sp 7mm
.***** HER DELES DEPOTNUMMER  OP I TO PARAMETRE ****
.se dregnr = substr &GENDEPNR 1 4
.se depnr = substr &GENDEPNR 5 6
&regnr &ktonr ¤&dregnr &depnr
.ar off
.*******************
.ar DATO on
&GENDATO12
.ar off
.*******fortsætter i t2 **************
.* MB ændring hvor linien starter med *MB
.da INDBPRIFAST    21mm 109,5mm width 168mm
.da INDBPRIENG     21mm 109,5mm width 168mm
.da INDBPRIOPF     21mm 131mm   width 168mm
.da INDBPRI15     21mm 109,5mm width 168mm
.da UDBETALING     21mm 163.7mm   width 168mm
.** SUBSTRING PÅ FØDSELSDAG ***********************************************
.su off
.se fdag = substr &KTOKNDNR1 1 2
.se fmd = substr &KTOKNDNR1 3 2
.se faar = substr &KTOKNDNR1 5 2
.** SUBSTRING PÅ OPRETTELSESDAG / MED VIRKNING FRA DATO *******************
.se odag = substr &GENDATO12 1 2
.se omd = substr &GENDATO12 4 2
.se oaar = substr &GENDATO12 7 4
.se oaar2 = substr &GENDATO12 9 2
.** SUBSTRING PÅ DATO FOR START PÅ UDBETALING *****************************
.se uddag = substr &GENSTART 1 2
.se udmd = substr &GENSTART 4 2
.se udaar = substr &GENSTART 7 4
.** SUBSTRING PÅ DAGS DATO ************************************************
.se daar = substr &DATO 9 2
.su on
.if x&faar > x&daar
.th .se aarstal = 1900
.el .se aarstal = 2000
.** FØDEÅR (faar1), MINIMUMSLØBETID (udminaar)*****************************
.se faar1 = &faar + &aarstal
.se minaar = &faar1 + 55
.se udminaar = &oaar + 5
.se udminaar1 = &faar1 + 60
.se udmaxaar = &faar1 + 76
.***** HER TESTES PÅ OM KONTOHAVER ER YNGRE END 55 ÅR (§ 15A) ************
.if &L'&GENPRI15A gt 0
.th .go OPRET
.el .go ANDRE
...OPRET
.if x&oaar < x&minaar
.th .go FEJL3
.if x&oaar > x&minaar
.th .go ALDER
.if x&omd < x&fmd
.th .go FEJL3
.if x&omd > x&fmd
.th .go ALDER
.if x&odag < x&fdag
.th .go FEJL3
.el .go ALDER
...FEJL3
.* MB mg /T/Kunden skal være mindst 55 år/
.***** HER TESTES PÅ OM KONTOHAVER ER OVER 60 ÅR - GÆLDER FOR ØVRIGE ******
...ANDRE
.if x&oaar > x&udminaar1
.th .go FEJL4
.if x&oaar < x&udminaar1
.th .go ALDER
.if x&omd > x&fmd
.th .go FEJL4
.if x&omd < x&fmd
.th .go ALDER
.if x&odag < x&fdag
.th .go ALDER
.el .go FEJL4
...FEJL4
.* MB mg /T/Kunden skal være under 60 år ved oprettelse/
.**TEST PÅ AT ALDER VED UDBETALINGSSTART ER MIN. 5 ÅR EFTER OPRETTELSE*****
...ALDER
.if x&udaar < x&udminaar
.th .go FEJL5
.if x&udaar > x&udminaar
.th .go GOD1
.if x&udmd < x&omd
.th .go FEJL5
.if x&udmd > x&omd
.th .go GOD1
.if x&uddag < x&odag
.th .go FEJL5
.el .go GOD1
...FEJL5
.* MB th .mg /T/Udbetalingens startår min. 5 år efter oprettelse/
...GOD1
.** INGEN MAXIMUM (76 ÅR) PÅ § 15A ****************************************
.if &L'&GENPRI15A > 0
.th .go MINAAR
.*TEST START********
.***** HER TESTES PÅ OM KONTOHAVER ER ÆLDRE END 76 ÅR *********************
.if x&udaar > x&udmaxaar
.th .go FEJL6
.if x&udaar < x&udmaxaar
.th .go MINAAR
.***** HER TESTES PÅ OM KONTOHAVER ER YNGRE END 60 ÅR *********************
...MINAAR
.if x&udaar < x&udminaar1
.th .go FEJL6
.if x&udaar > x&udminaar1
.th .go OK1
.***** HER TESTES OM ÅRSTAL ER RIGTIGT MEN AT MÅNEDERNE GØR AT KONTOHAVER *
.***** ER FYLDT 76/60 ÅR***************************************************
.if x&udmd < x&fmd
.th .go FEJL6
.if x&udmd > x&fmd
.th .go OK1
.if x&uddag < x&fdag
.th .go FEJL6
.el .go OK1
.***** HER AFSLUTTES TESTEN PÅ UDLØBSDATOEN *******************************
...FEJL6
.if &L'&GENPRI15A > 0
.* MB th .mg /T/Man skal være fyldt 60 år ved udbetalingsstart/
.* MB el .mg /T/Man skal være mellem 60 og 76 år ved udbetalingsstart/
...OK1
.*INGEN MAX. PÅ § 15A *****************************************************
.if &L'&GENPRI15A > 0
.th .go AAR15A
.el .go OEVRIGE
...AAR15A
.if X&GENANTUDÅR < X10
.th .mg /T/Antal udbetalingsår skal være mindst 10 år/
.el .go KTONR
...OEVRIGE
.* MB maxår ændret fra 25 til 50
.if X&GENANTUDÅR < X10
.or X&GENANTUDÅR > X50
.th .mg /T/Antal udbetalingsår skal være mellem 10 og 50 år/
...KTONR
.*******************************************
.se regnr2 = substr &GENKTNR1 1 4
.se ktonr2 = substr &GENKTNR1 5 11
.*******************************************
.ar INDBPRIFAST on
.*** privat fast beløb  ***
.if &L'&GENPRIFAST gt 0
.th .go PFAST
.el .go PFASTSL
...PFAST
.tp 72mm char ,  142mm char ,
.if x&GENLØNINDB eq x1
.th ¤&GENKR
.th .go PRIKTO
.if x&GENLØNINDB eq x2
.th ¤&GENKR ¤&RESULTH
.th .go PRIKTO
.if x&GENLØNINDB eq x3
.th ¤&GENKR ¤&RESULTB
.th .go PRIKTO
.if x&GENLØNINDB eq x4
.th ¤&GENKR ¤&RESULTC
.th .go PRIKTO
.if x&GENLØNINDB eq x5
.th ¤&GENKR ¤&RESULTD
.th .go PRIKTO
.if x&GENLØNINDB eq x6
.th ¤&GENKR ¤&RESULTI
...PRIKTO
.sp 3mm
.tp 35mm char , 75mm 80mm 120mm
.if &L'&GENKTNR1 gt 0
.th ¤&GENKR ¤¤&GENDATO12 ¤&regnr2 &ktonr2..
.el ¤&GENKR ¤¤&GENDATO12..
...PFASTSL
.ar off
.***************************************
.ar INDBPRIENG on
.*** privat engangsindskud / § 15A ***
.if &L'&GENPRIENGA gt 0
.or &L'&GENPRI15A gt 0
.th .go PENG
.el .go PENGSL
...PENG
.tp 79mm char ,
¤&GENKR
.sp 2,8mm
.tp 35mm char , 66mm 74mm 115mm
.if &L'&GENKTNR1 gt 0
.th ¤&GENKR ¤¤&regnr2 &ktonr2 ¤&GENDATO12..
.el ¤&GENKR ¤&GENDATO12..
...PENGSL
.ar off
.*****************************************
.ar INDBPRIOPF on
.*** privat op til opfyldningsfradraget ****
.if &L'&GENPRIOPFY gt 0
.th .go POPFY
.el .go POPFYSL
...POPFY
.tp 45mm
.*** hvis beløb = 0, skal kun datoen udskrives****
.if &GENKR eq 0,00
.th ¤&GENDATO12..
.th .go POPFYSL
.tp 52mm char , 87mm 97mm 126mm 132mm
.if &L'&GENKTNR1 gt 0
.th ¤&GENKR ¤&GENDATO12 ¤¤&regnr2 &ktonr2..
.el ¤&GENKR ¤&GENDATO12..
...POPFYSL
.ar off
.*********************
.ar UDBETALING on
.tp 38mm 60mm 105mm 137mm
.se alder = &udaar - &faar1
.se alderslut = &alder + &GENANTUDÅR - 1
¤¤&GENSTART ¤&udaar ¤&alder
.sp 0.5mm
¤&GENANTUDÅR ¤¤¤&alderslut..
.ar off
.*********************
